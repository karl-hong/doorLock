# doorLock

## 1.硬件配置

- RS485引脚
    - RTS: PA12
    - CTS: PA11
    - TX: PA9
    - RX: PA10
- 电机驱动
    - A: PB12
    - B: PB11
    - C: PB10
    - D: PB2
- Gsensor
    - SDA: PF7
    - SCL: PF6
- 灯条控制
    - L1: PB4，高有效
    - L2: PB3，高有效
- 钥匙检测
    - KEY: PB8
- 门磁检测
    - DOOR1: PB15
    - DOOR2: PB14
- 锁状态检测
    - LOCK1: PB6
    - LOCK2: PB7
- 指示灯
    - RED: PB1，低有效
    - GREEN: PB0，低有效
- debug口
    - RX: PA3
    - TX: PA2

## 2.协议

### （1）单锁状态查询指令
> - 请求帧：帧头 + 指令 + 操作码 + 长度 + UID + 校验码 + 帧尾
> - 应答帧：帧头 + 指令 + 操作码 + 长度 + 地址 + 锁状态 + 门磁1状态 + 门磁2状态 + 钥匙反馈开关状态 + 关锁延时 + 是否开启关锁延时 + 灯1状态 + 灯2状态 + 报警状态 + 是否开启上报 + UID + 校验码 + 帧尾

### （2）批量开关锁指令
> - 请求帧：帧头 + 指令 + 操作码 + 长度 + 开关锁 + 校验码 + 帧尾
> - 应答帧：无

### （3）单锁开关锁指令
> - 请求帧：帧头 + 指令 + 操作码 + 长度 + 开关锁 + UID + 校验码 + 帧尾
> - 应答帧：帧头 + 指令 + 操作码 + 长度 + 地址 + 开关锁 + UID + 校验码 + 帧尾

### （4）批量基础设置指令
> - 请求帧：帧头 + 指令 + 操作码 + 长度 + 关锁延时 + 关锁延时启动标志 + 主动上报启动标志 + 校验码 + 帧尾
> - 应答帧：无

### （5）单锁基础设置指令
> - 请求帧：帧头 + 指令 + 操作码 + 长度 + 地址 + 关锁延时 + 关锁延时启动标志 + 主动上报启动标志 + UID + 校验码 + 帧尾
> - 应答帧：帧头 + 指令 + 操作码 + 长度 + 地址 + 关锁延时 + 关锁延时启动标志 + 主动上报启动标志 + UID + 校验码 + 帧尾

### （6）批量灯带设置指令
> - 请求帧：帧头 + 指令 + 操作码 + 长度 + 灯带开关 + 校验码 + 帧尾
> - 应答帧：无

### （7）单灯带开关设置指令
> - 请求帧：帧头 + 指令 + 操作码 + 长度 + 灯带1开关设置 + 灯带2开关设置 + UID + 校验码 + 帧尾
> - 应答帧：帧头 + 指令 + 操作码 + 长度 + 地址 + 灯带1开关设置 + 灯带2开关设置 + UID + 校验码 + 帧尾

### （8）批量清除报警状态指令
> - 请求帧：帧头 + 指令 + 操作码 + 长度 + 校验码 + 帧尾
> - 应答帧：无

### （9）单锁清除报警状态指令
> - 请求帧：帧头 + 指令 + 操作码 + 长度 + UID + 校验码 + 帧尾
> - 应答帧：帧头 + 指令 + 操作码 + 长度 + 地址 + 报警状态 + UID + 校验码 + 帧尾

### （10）单锁手动开关上报指令
> - 请求帧：帧头 + 指令 + 操作码 + 长度 + 地址 + 报警类型 + UID + 校验码 + 帧尾
> - 应答帧：无

### （11）延时自动关锁上报指令
> - 请求帧：帧头 + 指令 + 操作码 + 长度 + 地址 + UID + 校验码 + 帧尾
> - 应答帧：无

### （12）单锁开关锁异常上报指令
> - 请求帧：帧头 + 指令 + 操作码 + 长度 + 地址 + 报警类型 + UID + 校验码 + 帧尾
> - 应答帧：无

### （13）单锁振动查询指令
> - 请求帧：帧头 + 指令 + 操作码 + 长度 + UID + 校验码 + 帧尾
> - 应答帧：帧头 + 指令 + 操作码 + 长度 + 地址 + x轴数据 + y轴数据 + z轴数据 + UID + 校验码 + 帧尾
> 